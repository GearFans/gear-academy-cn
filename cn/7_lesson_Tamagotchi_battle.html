<html lang="zh-CN" class="translated-ltr"><head>
  <base href="https://108.ufo.k0s.io/7_lesson_Tamagotchi_battle.md"> 
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      document.title = window.location.hostname;
    });
  </script> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <style>
    body {
      font-family: "Arial", sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }

    h1 {
      font-size: 2rem;
      color: #222;
      margin-bottom: 10px;
    }

    h1 a {
      color: #222;
      text-decoration: none;
    }

    a {
      color: #2a7ae2;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    p {
      margin-bottom: 20px;
    }

    hr {
      border: 0;
      border-top: 1px solid #eee;
      margin: 20px 0;
    }

    table {
      border-collapse: collapse;
      width: 50%;
    }

    th, td {
      border: 1px solid black;
      padding: 8px;
      text-align: left;
    }

    th {
      background-color: #f2f2f2;
    }
  </style> 
  <meta http-equiv="X-Translated-By" content="Google">
  <meta http-equiv="X-Translated-To" content="zh-CN">
  <script type="text/javascript" src="https://www.gstatic.com/_/translate_http/_/js/k=translate_http.tr.en_US.WYPRFnOi8do.O/d=1/rs=AN8SPfpuhFJPZIC1bAeelVoE7UV7Vt-MPA/m=corsproxy" data-sourceurl="https://108.ufo.k0s.io/7_lesson_Tamagotchi_battle.md" data-navigation-history-proxy-enabled="true"></script>
  <meta name="robots" content="none">
 <script async="" src="https://www.gstatic.com/feedback/js/help/prod/service/lazy.min.js"></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="https://www.gstatic.com/_/translate_http/_/ss/k=translate_http.tr.69JJaQ5G5xA.L.W.O/d=0/rs=AN8SPfpC36MIoWPngdVwZ4RUzeJYZaC7rg/m=el_main_css"><script type="text/javascript" charset="UTF-8" src="https://translate.googleapis.com/_/translate_http/_/js/k=translate_http.tr.zh_CN.vP9ARk0hD0A.O/d=1/exm=el_conf/ed=1/rs=AN8SPfr7Qhi-OTQKbFnpEq_vjdvjiKNGqA/m=el_main"></script><title>108-飞碟-k0s-io.translate.goog</title></head> 
 <body style="margin-top: 56px;">
  <script type="text/javascript" src="https://www.gstatic.com/_/translate_http/_/js/k=translate_http.tr.en_US.WYPRFnOi8do.O/d=1/exm=corsproxy/ed=1/rs=AN8SPfpuhFJPZIC1bAeelVoE7UV7Vt-MPA/m=navigationui" data-environment="prod" data-proxy-url="https://108-ufo-k0s-io.translate.goog" data-proxy-full-url="https://108-ufo-k0s-io.translate.goog/7_lesson_Tamagotchi_battle.md?_x_tr_sl=en&amp;_x_tr_tl=zh-CN&amp;_x_tr_hl=zh-CN&amp;_x_tr_pto=wapp" data-source-url="https://108.ufo.k0s.io/7_lesson_Tamagotchi_battle.md" data-source-language="en" data-target-language="zh-CN" data-display-language="zh-CN" data-detected-source-language="" data-is-source-untranslated="false" data-source-untranslated-url="https://translate.google.com/website?sl=en&amp;tl=zh-CN&amp;hl=zh-CN&amp;client=webapp&amp;u=https://108.ufo.k0s.io/7_lesson_Tamagotchi_battle.md&amp;anno=2" data-use-in-place-translation="true" data-client="webapp"></script> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第 7 课：Tamagotchi 战斗逻辑与实施</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">课程总结</font></font></p> 
  <ul> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本课的重点是促进两个电子宠物之间战斗的契约。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font class="" style="vertical-align: inherit;">战斗契约可以处于四种状态之一：Registration、Moves、Waiting 和 GameIsOver。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Battle 结构包含有关玩家的信息、游戏的当前状态、当前回合、Tamagotchi 商店 ID、获胜者以及到目前为止所走的步数。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font class="" style="vertical-align: inherit;">要参与游戏，用户必须允许他们的合约接收与游戏相关的消息，如 TmgAction::TmgInfo 和 StoreAction::GetAttributes。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册函数从商店获取电子宠物主人的信息及其属性，随机生成电子宠物的力量和能量，并注册电子宠物。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_owner 和 get_attributes 函数分别从商店中检索有关 Tamagotchi 所有者和属性的信息，而 get_turn 和 generate_power 函数分别生成伪随机数以确定谁开始游戏和 Tamagotchi 的功率。</font></font></p> </li> 
  </ul> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">课程目标</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在课程结束时，您将：</font></font></p> 
  <ul> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">理解促成两个电子宠物之间战斗的契约。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了解 Battle 结构体中包含的信息，例如玩家信息、游戏状态、获胜者和到目前为止所走的步数。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">领悟战斗契约状态并理解它们的作用</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了解用于从商店检索信息和生成伪随机数的函数，例如 get_owner、get_attributes、get_turn 和 generate_power。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成宠物蛋对战的简单实现</font></font></p> </li> 
  </ul> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们开始吧！</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">战斗契约可以有3种状态：</font></font></p> 
  <ul> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册：战斗契约等待电子宠物主人注册；</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">移动：Tamagotchi 所有者轮流移动；</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等待：在电子宠物主人采取行动后，战斗契约让他们有时间装备电子宠物。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GameIsOver：战斗结束，需要发送消息StartNewGame。</font></font></p> </li> 
  </ul> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">战斗程序状态：</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">玩家是以下结构的地方：</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要参与，用户必须允许他们的合约接收与游戏相关的消息，如下所示：</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它将响应有关电子鸡所有者的信息：</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们还将添加消息</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到允许我们获得 Tamagotchi 属性的商店合约</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册函数：</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它允许注册两个 Tamagotchi 进行战斗。</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[图像占位符]</font></font></p> 
  <ol> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在您注册宠物蛋之前，战斗合约必须从商店接收宠物蛋的所有者及其属性；</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">收到详情后，战斗契约随机生成电子宠物的力量和能量；</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果一只电子鸡被注册，它会保持在注册状态；</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果注册了两个 Tamagotchi，战斗契约将随机确定谁先开始游戏并进入 Moves 状态。</font></font></p> </li> 
  </ol> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_owner 函数从 Tamagotchi 合约中检索 Tamagotchi 的所有者。</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同样，get_attributes 函数从商店中检索 Tamagotchi 的属性。</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了确定哪个玩家开始游戏，我们使用 get_turn 函数，它伪随机选择起始玩家：</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genetate_power 函数伪随机生成电子宠物的功率值：</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有两个常量 MAX_POWER 和 MIN_POWER，它们定义了 Tamagotchi 功率的上限和下限：</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来，作为例子，我们将定义一个非常简单的游戏机制：</font></font></p> 
  <ol> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamagotchi 所有者只需向战斗合约发送一条消息 BattleAction::Move 即可采取行动。</font><font style="vertical-align: inherit;">在那一步中，他们的 Tamagotchi 击败了对手的 Tamagotchi。</font><font style="vertical-align: inherit;">对手的能量会随着攻击的力量而减少。</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在，电子鸡商店里只有一个属性可以在游戏中使用——一把剑。</font><font style="vertical-align: inherit;">如果攻击的电子宠物有剑，其攻击力乘以 SWORD_POWER：</font></font></p> </li> 
  </ol> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SWORD_POWER * 功率</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">否则玉子的攻击力简直就是他们的力量。</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以后可以通过在商店中添加战斗属性来扩展逻辑，还可以添加电子宠物在场地上的移动。</font></font></p> 
  <ol start="3"> 
   <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果两个玩家都进行了三步，游戏进入等待状态，玩家可以从商店购买物品来装备他们的电子宠物。</font><font style="vertical-align: inherit;">经过一段设定的延迟后，Tamagotchis 的状态会更新，下一轮开始。</font></font></li> 
  </ol> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[图像占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UpdateInfo 操作只是更新 Tamagotchi 状态的变化并开始下一轮：</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[代码占位符]</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">至此，电子鸡对战的简单实现就完成了。</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以尝试与您的宠物蛋一起战斗，或者创建一些电子宠物蛋（使用上一课）并让它们战斗（链接到网络应用程序）。</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在是你的课程作业时间。</font></font></p> 
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">课程作业：</font></font></p> 
  <ul> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为商店契约增加更多的战斗属性；</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确定这些属性的力量。</font><font style="vertical-align: inherit;">您还可以添加升级各种属性的机会（这也需要扩展商店合约的逻辑）；</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许玩家选择他将在回合中战斗或防御的武器；</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也可以为 Tamagotchi 添加向左或向右移动的能力；</font></font></p> </li> 
   <li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发挥创意并考虑其他可能的方法来使游戏更有趣。</font></font></p> </li> 
  </ul>  
  <script>function gtElInit() {var lib = new google.translate.TranslateService();lib.translatePage('en', 'zh-CN', function () {});}</script>
  <script src="https://translate.google.com/translate_a/element.js?cb=gtElInit&amp;hl=zh-CN&amp;client=wt" type="text/javascript"></script><div id="goog-gt-" class="VIpgJd-suEOdc VIpgJd-yAWNEb-L7lbkb skiptranslate" dir="ltr" style="visibility: hidden; left: 255px; top: 2882px; display: none;"><div style="padding: 8px;"><div><div class="VIpgJd-yAWNEb-l4eHX"><img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div style="padding: 8px; float: left; width: 100%;"><h1 class="VIpgJd-yAWNEb-r4nke VIpgJd-yAWNEb-mrxPge">原文</h1></div><div style="padding: 8px;"><div class="VIpgJd-yAWNEb-nVMfcd-fmcmS">To participate in the game, users must allow their contracts to receive game-related messages like TmgAction::TmgInfo and StoreAction::GetAttributes.</div></div><div class="VIpgJd-yAWNEb-cGMI2b" style="padding: 8px;"><div class="VIpgJd-yAWNEb-Z0Arqf-PLDbbf"><span class="VIpgJd-yAWNEb-Z0Arqf-hSRGPd">提供更好的翻译建议</span></div><div class="VIpgJd-yAWNEb-fw42Ze-Z0Arqf-haAclf"><hr style="color: #ccc; background-color: #ccc; height: 1px; border: none;"><div class="VIpgJd-yAWNEb-Z0Arqf-H9tDt"></div></div></div><div class="VIpgJd-yAWNEb-jOfkMb-Ne3sFf" style="display: none; opacity: 0;"></div></div>
 
</body></html>
